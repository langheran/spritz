Downloaded from SAE International by American Univ of Beirut, Monday, July 30, 2018

SAE TECHNICAL PAPER SERIES

2006-01-1290

A Method for Camera Vision Based Parking Spot Detection
Tim Weis, Benjamin May and Christian Schmidt
MAGNA

Reprinted From: Automotive Lighting Technology and Human Factors in Driver Vision and Lighting; Rear Vision and Indirect Vision (SP-1993)
2006 SAE World Congress Detroit, Michigan April 3-6, 2006
400 Commonwealth Drive, Warrendale, PA 15096-0001 U.S.A. Tel: (724) 776-4841 Fax: (724) 776-5760 Web: www.sae.org

Downloaded from SAE International by American Univ of Beirut, Monday, July 30, 2018
The Engineering Meetings Board has approved this paper for publication. It has successfully completed SAE's peer review process under the supervision of the session organizer. This process requires a minimum of three (3) reviews by industry experts. All rights reserved. No part of this publication may be reproduced, stored in a retrieval system, or transmitted, in any form or by any means, electronic, mechanical, photocopying, recording, or otherwise, without the prior written permission of SAE.
For permission and licensing requests contact: SAE Permissions 400 Commonwealth Drive Warrendale, PA 15096-0001-USA Email: permissions@sae.org Tel: 724-772-4028 Fax: 724-776-3036
For multiple print copies contact: SAE Customer Service Tel: 877-606-7323 (inside USA and Canada) Tel: 724-776-4970 (outside USA) Fax: 724-776-0790 Email: CustomerService@sae.org
ISSN 0148-7191 Copyright  2006 SAE International Positions and opinions advanced in this paper are those of the author(s) and not necessarily those of SAE. The author is solely responsible for the content of the paper. A process is available by which discussions will be printed with the paper if it is published in SAE Transactions. Persons wishing to submit papers to be considered for presentation or publication by SAE should send the manuscript or a 300 word abstract to Secretary, Engineering Meetings Board, SAE. Printed in USA

Downloaded from SAE International by American Univ of Beirut, Monday, July 30, 2018
2006-01-1290
A Method for Camera Vision Based Parking Spot Detection

Copyright © 2006 SAE International

Tim Weis, Benjamin May and Christian Schmidt
MAGNA

ABSTRACT
A main requirement for a driver assisting automated parking system is the identification and localisation of a free parking spot. A sensory system consisting of a reverse aid camera, a processing unit, vehicle track sensors and a link to the vehicles CAN-Bus is able to detect a parking spot, using vision processing algorithms.
This report starts with a case differentiation regarding parking situations. In reality a combination between several attributes and conditions define the initial parking situation and the specific demand on the sensory system to detect the parking spot.
The described method for camera vision based parking spot detection is characterised on specific situations, such as parking spots marked by painted lines and the kerbstone and well lighted rich-contrast situations. The method in general starts with the image processing on the incoming camera images. Based on the detection of attributes hypotheses for the identification of free parking spots are established and centralised in a hypotheses pool. Beneath the detected attributes another evaluation criteria is established, by the tracking of the hypothetical parking spots during the movement of the car. The most presumable parking spot is then displayed in the image of the reverse aid camera.
The report concludes with an evaluation of the achieved results under specific initial parking situations.
INTRODUCTION
In the recent past more and more car manufacturers introduced innovative solutions for making parking easier and safer for the customer. Starting with reverse aid cameras, providing the vehicles rear view to the driver, now a trend to guided and, finally, automated parking is obvious. A main requirement for such driver assistance systems is the identification and localization of a free parking spot.
Several sensor systems can help to fulfill this task. An already known method for measuring and detecting parking spots is based on distance measuring sensors such as ultrasonic- and RADAR-sensors. They allow to measure distances between the sensor and 3dimensional objects and therefore enable the system to scan the surrounding of the car, while driving under a designated speed alongside a parking spot.

The main excellence of the distance measurement sensors is the detection of 3-dimensional objects. Ignoring even the individual principal strength and weakness of ultrasonic- and RADAR-sensors it is not possible to use them for the detection of 2dimensional markings, as these are not raised above the plain floor. A camera vision system is the adequate solution, to fulfill this task.
TECHNICAL REQUIREMENTS In this section it is declared that parking spots are not always marked by 3-dimensional objects, but also by 2dimensional or very weak raised 3-dimensional (e.g. a short kerbstone) markings. For an increased performance in parking spot measurement and detection it is therefore necessary to detect all kinds of parking spots, even if they are limited by 2-dimensional markings.
Figure 1: technical requirements - schematic diagram of the camera vision system
The method described in this paper is based on a Vision system consisting of a reverse aid camera on the rear of the vehicle, a vision processing unit, vehicle track sensors and a link to the vehicles CAN-Bus. This system is able to detect a parking spot behind the vehicle, using vision processing algorithms. Figure 1 shows a schematic diagram of the designated vision system. The

Downloaded from SAE International by American Univ of Beirut, Monday, July 30, 2018

use of this Vision system provides several crucial advantages:
· It is possible to detect the majority of visible parking spot markings (2- and 3-dimensional) using vision processing algorithms. At the same time, the reverse aid camera can be used to provide the driver a picture on a display of the rear surrounding of the car and therefore enables him to evaluate this scene by himself.
· Reverse aid cameras currently started to enter the automotive market. It is apparent to use it for additional functions and as a part in the automotive sensor fusion systems also for parking spot detection and measurement.
CONDITIONS FOR THE CAMERA VISION BASED PARKING SPOT DETECTION AND MEASUREMENT
In general most parking manoeuvres can be defined as parallel and perpendicular parking situations. The main differentiating factor at this juncture is on which side the parking spot is entered by the car. Considering the parking spot as a rectangle it is imperative, that in parallel parking situations a long side of that rectangle is entered by the car (cp. figure 2). As under real conditions it is considered as most challenging the requirements for the parking spot measurement and detection is mainly focussed on parallel parking.

· weather affected road conditions (e.g. snow on the road)
3. surrounding conditions: · weather conditions (e.g. snowing, raining) · illumination conditions (Weis, [6]) · daytime illumination (e.g. day, dusk, night) · direct light irradiation (e.g. by the sun, vehicle headlights) · artificial light irradiation (e.g. street lights)
In reality a combination between these attributes and conditions define the initial parking situation and the specific demand on the sensory system to detect the parking spot. Figure 3 and 4 show examples of real parking situations, as they would be seen by a camera vision system. It is apparent that from the plurality and combination of the conditions and attributes there is a wide range of performance requirements for the camera vision system.

Perpendicular

Parallel

Figure 2: differentiation between perpendicular & parallel parking ­ origin: Schmidt, [5]

Beneath the differentiation of the parking situation there are several factors influencing the conditions and requirements for the camera vision based parking spot detection and measurement:

1. typical attributes limiting a parking spot in real traffic situation:
· painted lines · kerbstone · vehicles · arbitrary 3-dimensional obstacles
(e.g. vegetation, pile, stones)
· non plain floor (e.g. acclivity, ditch) 2. road conditions:
· paving (e.g. asphalt, concrete, paving stones, gravel)
· road surface condition (e.g. partial damaged)

Figure 3: good conditions: good visibility, rich contrast, strong markings
Figure 4: bad conditions: good visibility but weak markings, cracks on the road surface, strong shadows
The purpose of this paper is to describe the principal method for the camera vision based parking spot detection by means of one specified combination of attributes and conditions. This combination is an optimal,

Downloaded from SAE International by American Univ of Beirut, Monday, July 30, 2018

but obvious very common parallel parking situation. It is described as:
· Painted lines limiting the parking spot on the front and rear,
· Curbstone limiting the parking spot in its width, · Non damaged and dry asphalt road , · Good weather conditions without rain, snow or fog, · Indirect illumination.

METHOD FOR CAMERA VISION BASED PARKING SPOT DETECTION
The method is divided in the following main parts: · Pre-process · Edge-detection and vectorisation · Semantical analysis

PRE-PROCESS:
The first step of the pre-process is the reduction of noise by applying a noise filter (Jähne [1]) to the incoming camera picture. The next phase includes a colour differentiation in the image by excluding coloured pixels. The default approach is that street markers are nearly white objects, the street itself looks like a more or less noisy grey. So it is functional to exclude all pixels with saturated colours far from grey from black to white.
Using the RGB colour model this is a complicated calculation. The different grey values are
located on the space diagonal line  from
black = (0, 0, 0) to white = (255, 255, 255) . A colour can be called near grey, if it is contained in a  - tube around . A closer look at this tube leads to the observation that  is a non-linear function of luminance.
This leads to the use of the HIS (Hue, Intensity, Saturation) colour model (Gonzales, [2]) (cp.
Figure 5). By using the HIS-colour model it is possible to exclude strong coloured pixels. The last step in this phase is the grey-level-projection.

I = r+g+b 3
S = max{r, g,b} - min{r, g,b} max{r, g,b}

 °

0

°

+

max{r,

g -b g,b} - min{r,

g , b}

 60

|

r

=

max{r,

g , b}

H

=

®°2 + °

b-r max{r, g,b}- min{r,

 60 | g , b}

g

=

max{r,

g , b}

° ° ¯

4

+

max{r,

g,

r-g b} - min{r,

g

, b}



60

|

b

=

max{r,

g

, b}

Figure 5: HIS Colour model

EDGE-DETECTION AND VECTORISATION:

An edge-detection (Jähne [1]) can be realized by using a Kirsch-Filter (Parker [3]). An example for this symmetric linear filter-matrix is shown in Figure 6.

§ 3 3 -5·

^
T

=

¨ ©¨¨

3 3

0 3

--55¸¸¸¹ .

Figure 6:Kirsch Filter

By using several matrices it is possible to find the direction of the edges. Especially at this point it is easy to ignore all edges that are not compatible with a given parallel parking spot direction hypothesis. The next step is to find isolated edge points which do not belong to edges but correspond to image noise.

Figure 7:edge detection
The following image processing step is the vectorisation of all found edges (Sonka [4]). It is useful to use the basic information about the searched objects. The painted parking spot markings are straight lines and when the system is looking for parallel parking it is known that those lines have to be horizontal with some tolerances. The method works with images with a corrected optical distortion. Therefore it could erase all other non straight edges, because these are not important for the detection of parking spot markings.
SEMANTICAL ANALYSIS:
By using the parking spot direction hypothesis and the length relations of a typical parking spot the perspective of the detected parking spot is recognised. This step is only possible under the following conditions:
· The camera is directed at a plane street. · The system works with a nearly optimal
distortion correction.

Downloaded from SAE International by American Univ of Beirut, Monday, July 30, 2018

After a parking spot is detected its length is measured by the distance of the different edges in the image. By this way it is possible to decide whether the parking spot is big enough to park the vehicle.
RESULTS
The results shown in this section refer to the described method applied to images with the specified combination of attributes and conditions defined above. The method can be applied to a defined section of the image, which could be the complete image, or parts of it. Considering the following images as examples, this section is displayed as a green frame. Once a parking spot is detected it is displayed as a red overlay in the image. This overlay represents the correct perspective of the parking spot on the road as it was interpreted by the method.
Figure 8 and 9 show the detection results considered as correct and feasible for a parking spot measurement system.

figure 10: result of detection method considered as not feasible

figure 11: parking spot rear to the vehicle not detected

Figure 8: result of detection method considered as correct
figure 9: result of detection method considered as correct
Figure 10 and 11 show detection results considered as not feasible for a parking spot measurement system.

DISCUSSION AND CONCLUSION
The limits which are apparent at the detection of parking spot markings can be separated into two main groups. One corresponds to technical requirements and conditions like optical factors and the second is affected to semantic difficulties and the ability of the method to interpret the detection result.
The described method is mainly based on edge detection with the help of image processing. Therefore a feasible detection of painted street markings relies on good visibility conditions. Under restraints like bad illumination and other disturbing factors (e.g. rain, fog) the detection performance is partial strongly decreased.
Regarding the second group of semantic problems it is obvious, that the method considers painted parking spot markings in a certain way how they are situated on the street behind or next to a vehicle. Additional markings on the road, that do not refer to a parking spot are another disturbing factor, as the method doesn't

Downloaded from SAE International by American Univ of Beirut, Monday, July 30, 2018

know, which marking belongs to a parking spot and which not. Finally there is an infinite range of attributes limiting a parking spot in reality (e.g. Small steel hats or red paving stones). The method is designed only to deal with the most common situations.
The described method detects parking spots marked by painted road markings. By considering more attributes and their semantical coherences it can be an important part of a parking spot detection and measurement system as this would allow compliance with the entire requirements of such systems regarding the consideration of 2- and 3-dimensional parking spot markings.

REFERENCES

1. B. Jähne, "Digital image processing", SpringerVerlag, New York, 1997

2. R.C. Gonzalez, R.E. Woods, "Digital Image Processing", Prentice-Hall, London, 2001

3. J.R. Parker, "Algorithms for image processing and computer vision", Jon Wiley & Sons, New York, 1997

4. M. Sonka, V. Hlavac, R. Boyle, "Image processing, Analysis and Machine Vision", Brooks/Cole Publishing, 1999

5. C.Schmidt, "Erarbeitung und Bewertung einer

automatisierbaren

Einparkstrategie

unter

technischen, ergonomischen und wirtschaftlichen

Gesichtspunkten, als Bestandteil eines

fahrerunterstützenden Informationssystems zur

Einparkhilfe ", TU-Ilmenau 2004

6. T.Weis, "Leuchtdichte und Kontraststeuerung von Displays bei Verwendung als elektronische Rückspiegel", TU-Ilmenau, 2002

